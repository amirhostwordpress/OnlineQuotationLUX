# Updated Pricing Structure Guide

## Overview

The pricing structure has been updated to include comprehensive fabrication, delivery, and installation costs with new rates and calculation methods. This ensures accurate cost calculations for all quotation services.

## Updated Pricing Structure

### 1. BASIC PROCESSING COSTS (multiply by total square meters)

| Service | Rate | Calculation |
|---------|------|-------------|
| **Cutting** | 40 AED/sqm | Total sqm × 40 AED |
| **Top Polishing/Mitred** | 80 AED/sqm | Total sqm × 80 AED |
| **Polishing** | 40 AED/sqm | Total sqm × 40 AED |

**Total Basic Processing Cost = (Cutting + Top Polishing + Polishing) × Total Square Meters**

### 2. OPTIONAL ADD-ON SERVICES (client selection)

| Service | Rate | Type | Calculation |
|---------|------|------|-------------|
| **Butt Joint & Polish** | 50 AED/sqm | Per sqm | Total sqm × 50 AED |
| **Custom Edge** | 200 AED | Fixed cost | 200 AED (one-time) |
| **Hob Cut Out** | 100 AED | Fixed cost | 100 AED (one-time) |
| **Drain Grooves** | 250 AED | Fixed cost | 250 AED (one set) |
| **Small Holes** | 25 AED per hole | Per hole | Quantity × 25 AED |

### 3. SINK OPTIONS (choose one category)

#### Category A - Sink Provided by Client
| Sink Type | Rate | Description |
|-----------|------|-------------|
| **Under Mounted Sink** | 250 AED | Fixed cost |
| **Top Mounted Sink** | 200 AED | Fixed cost |

#### Category B - Sink Provided by Luxone
| Sink Type | Rate | Description |
|-----------|------|-------------|
| **Complete Sink Package** | 900 AED | Fixed cost |

### 4. DELIVERY & INSTALLATION

#### Packing & Delivery (location-based)
| Location | Rate | Description |
|----------|------|-------------|
| **Dubai** | 500 AED | Fixed cost |
| **All other UAE states** | 800 AED | Fixed cost |

#### Installation
| Service | Rate | Calculation |
|---------|------|-------------|
| **Installation** | 80 AED/sqm | Total sqm × 80 AED |

## Final Calculations

### Step-by-Step Calculation Process

1. **Material Cost**: Based on selected material and area
2. **Basic Processing Costs**: (40 + 80 + 40) × Total sqm = 160 AED/sqm
3. **Optional Add-ons**: Sum of selected services
4. **Sink Cost**: Based on selected category and type
5. **Delivery**: Based on location (Dubai: 500 AED, Other UAE: 800 AED)
6. **Installation**: 80 AED × Total sqm (if selected)

### Final Calculations

```
Subtotal = Material Cost + Basic Processing + Add-ons + Sink + Delivery + Installation

Company Profit = Subtotal × 20%

Subtotal with Profit = Subtotal + Company Profit

VAT = Subtotal with Profit × 5%

GRAND TOTAL = Subtotal with Profit + VAT
```

## Cost Breakdown Categories

### 1. Material Costs
- Base material cost calculations
- Material pricing from Luxone catalog or hardcoded fallback
- Customer-supplied material costs
- Brand supplier material costs

### 2. Basic Processing Costs
- **Cutting**: 40 AED/sqm - Cutting and shaping services
- **Top Polishing/Mitred**: 80 AED/sqm - Top surface polishing
- **Polishing**: 40 AED/sqm - General polishing services

### 3. Optional Add-on Services
- **Butt Joint & Polish**: 50 AED/sqm - Butt joint polishing
- **Custom Edge**: 200 AED fixed - Custom edge treatment
- **Hob Cut Out**: 100 AED fixed - Hob cut out service
- **Drain Grooves**: 250 AED fixed - Drain grooves installation
- **Small Holes**: 25 AED per hole - Small holes drilling

### 4. Sink Options & Installation
- **Sink Cost**: Variable based on category and type
  - Client provided: 200-250 AED
  - Luxone provided: 900 AED
- **Installation**: 80 AED/sqm - Professional installation services

### 5. Packing & Delivery
- **Location-based pricing**:
  - Dubai: 500 AED
  - All other UAE states: 800 AED

## Updated Profit Structure

### Previous vs New Profit Margin
- **Previous**: 30% profit margin
- **New**: 20% profit margin

### Calculation Impact
- **Reduced profit margin**: More competitive pricing
- **Better customer value**: Lower final costs
- **Maintained quality**: Same service standards

## Service Level Options

### Available Service Levels
1. **Fabrication Only**: Basic processing costs only
2. **Fabrication + Delivery**: Includes packing & delivery
3. **Fabrication + Delivery + Installation**: Complete service package

### Cost Inclusion by Service Level
| Service Level | Basic Processing | Add-ons | Sink | Delivery | Installation |
|---------------|------------------|---------|------|----------|--------------|
| Fabrication Only | ✅ | ✅ | ✅ | ❌ | ❌ |
| Fabrication + Delivery | ✅ | ✅ | ✅ | ✅ | ❌ |
| Fabrication + Delivery + Installation | ✅ | ✅ | ✅ | ✅ | ✅ |

## Example Calculations

### Example 1: Basic Kitchen Worktop
- **Area**: 10 sqm
- **Material**: Golden River Quartz (280 AED/sqm)
- **Service Level**: Fabrication + Delivery + Installation
- **Location**: Dubai
- **Add-ons**: Custom Edge, Hob Cut Out

**Calculation**:
```
Material Cost: 10 × 280 = 2,800 AED
Basic Processing: 10 × (40 + 80 + 40) = 1,600 AED
Add-ons: 200 + 100 = 300 AED
Sink: 900 AED (Luxone package)
Delivery: 500 AED (Dubai)
Installation: 10 × 80 = 800 AED

Subtotal: 2,800 + 1,600 + 300 + 900 + 500 + 800 = 6,900 AED
Company Profit: 6,900 × 20% = 1,380 AED
Subtotal with Profit: 6,900 + 1,380 = 8,280 AED
VAT: 8,280 × 5% = 414 AED
GRAND TOTAL: 8,280 + 414 = 8,694 AED
```

### Example 2: Bathroom Vanity
- **Area**: 2 sqm
- **Material**: Megistic White (260 AED/sqm)
- **Service Level**: Fabrication Only
- **Add-ons**: None

**Calculation**:
```
Material Cost: 2 × 260 = 520 AED
Basic Processing: 2 × (40 + 80 + 40) = 320 AED
Add-ons: 0 AED
Sink: 0 AED (not included)
Delivery: 0 AED (not included)
Installation: 0 AED (not included)

Subtotal: 520 + 320 = 840 AED
Company Profit: 840 × 20% = 168 AED
Subtotal with Profit: 840 + 168 = 1,008 AED
VAT: 1,008 × 5% = 50.40 AED
GRAND TOTAL: 1,008 + 50.40 = 1,058.40 AED
```

## Technical Implementation

### Updated Files
1. **`src/utils/pricingCalculator.ts`**: Updated calculation logic
2. **`src/components/admin/QuotationCostBreakdown.tsx`**: Updated display categories

### Key Changes
- **Basic processing rates**: Updated to new rates (40, 80, 40 AED/sqm)
- **Profit margin**: Changed from 30% to 20%
- **Delivery pricing**: Location-based (Dubai: 500 AED, Other UAE: 800 AED)
- **Installation rate**: 80 AED/sqm
- **Add-on descriptions**: Updated with new rates and types

### Calculation Flow
1. **Area Calculation**: Total square meters from product pieces
2. **Material Cost**: Based on selected material and area
3. **Processing Costs**: Area × respective rates
4. **Add-ons**: Sum of selected optional services
5. **Sink & Installation**: Based on service level and selections
6. **Delivery**: Location-based fixed cost
7. **Final Calculations**: Subtotal → Profit → VAT → Grand Total

## Benefits of Updated Structure

### For Customers
- **Transparent Pricing**: Clear breakdown of all costs
- **Competitive Rates**: Reduced profit margin for better value
- **Flexible Options**: Choose required services only
- **Location-based Delivery**: Fair pricing based on location

### For Business
- **Accurate Calculations**: Precise cost calculations
- **Profit Optimization**: Balanced profit margins
- **Service Flexibility**: Multiple service level options
- **Location Awareness**: Appropriate delivery pricing

### For System
- **Consistent Calculations**: Standardized pricing across all quotations
- **Easy Maintenance**: Clear rate structure for updates
- **Comprehensive Coverage**: All cost components included
- **Future-Ready**: Scalable structure for additional services

## Maintenance and Updates

### Updating Rates
1. **Basic Processing**: Modify rates in `pricingCalculator.ts`
2. **Add-on Services**: Update fixed costs and per-unit rates
3. **Delivery Pricing**: Adjust location-based rates
4. **Profit Margin**: Modify percentage in calculation

### Adding New Services
1. **Define Rate Structure**: Fixed cost vs per-unit pricing
2. **Update Calculator**: Add calculation logic
3. **Update Display**: Add to cost breakdown categories
4. **Test Calculations**: Verify accuracy

### Location Updates
1. **Add New Locations**: Extend delivery pricing logic
2. **Update Rates**: Modify location-based pricing
3. **Test Scenarios**: Verify calculations for each location

## Support and Troubleshooting

### Common Issues
1. **Rate Mismatches**: Verify rates in calculator match documentation
2. **Calculation Errors**: Check area calculations and rate applications
3. **Service Level Issues**: Ensure correct service inclusion logic
4. **Location Problems**: Verify delivery location handling

### Debug Tools
- **Console Logging**: Check calculation steps in browser console
- **Rate Verification**: Compare displayed rates with documentation
- **Calculation Testing**: Test with known values and expected results
- **Service Level Testing**: Verify correct cost inclusion by service level

## Version History

### v2.0.0 (Current)
- Updated basic processing rates (40, 80, 40 AED/sqm)
- Changed profit margin from 30% to 20%
- Implemented location-based delivery pricing
- Updated add-on service descriptions and rates
- Enhanced cost breakdown display categories
- Improved calculation accuracy and transparency
- Added comprehensive documentation
- Updated component displays with new rates
